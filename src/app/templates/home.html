{% extends "base.html" %}
{% block body %}
    <!-- Ê§úÁ¥¢„Éê„Éº -->
    <div class="search-bar">
        <input type="text" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÅßÊ§úÁ¥¢..." id="searchInput">
        <button type="submit" >Ê§úÁ¥¢</button>
    </div>

    <!-- TodoTab -->
    <div class="tabs">
        <button class="tab-link" onclick="openTab(event, 'Incomplete')">Êú™ÂÆå‰∫Ü üôÖ</button>
        <button class="tab-link" onclick="openTab(event, 'Complete')">ÂÆå‰∫Ü ‚úÖ</button>
    </div>

    <!-- TodoList -->
    <div id="Incomplete" class="tab-content">
        {% if incomplete_todos %}
            <ul>
                {% for todo in incomplete_todos %}
                    <li>
                        <div class="todo-item" onclick="toggleTodoDetails(event)">{{ todo.todo_title }}
                            <!-- Ë©≥Á¥∞ -->
                            {% if todo.todo_details %}
                                <div class="todo-detail" hidden>{{ todo.todo_details|safe }}</div>
                            {% else %}
                                <p class="todo-detail" hidden>Todo„ÅÆË©≥Á¥∞„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                            {% endif %}

                            <!-- ÊúüÊó• -->
                            {% if todo.due_date %}
                                <p class="due-date">ÊúüÊó•Ôºö{{ todo.due_date.strftime('%Y/%m/%d %H:%M') }}</p>
                            {% else %}
                                <p class="due-date non-due-date">ÊúüÊó•„Å™„Åó</p>
                            {% endif %}

                            <!-- ÁôªÈå≤Êó• -->
                            <p class="reg-todo-date" hidden>ÁôªÈå≤Êó•Ôºö{{ todo.registration_date.strftime('%Y/%m/%d %H:%M') }}</p>

                            <!-- Á∑®ÈõÜ„Éú„Çø„É≥ -->
                            <div class="todo-edit-buttons" hidden>
                                <form action="/todo/delete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-del-btn">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                                <form action="/todo/amend/{{ todo.todo_id }}" method="get" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-edit-btn">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </form>
                                <form action="/todo/complete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-complete-btn">
                                        <i class="fas fa-check"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Êú™ÂÆå‰∫Ü„ÅÆTodo„ÅØÁèæÂú®„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
        {% endif %}
    </div>

    <div id="Complete" class="tab-content" style="display: none;">
        {% if completed_todos %}
            <ul>
                {% for todo in completed_todos %}
{#                    <li>#}
{#                        <a href="#" class="todo-item">{{ todo.todo_title }}#}
{#                            <p>ÁôªÈå≤Êó•Ôºö{{ todo.registration_date }}<br>ÂÆå‰∫ÜÊó•‚úÖÔºö2024/03/34</p>#}
{#                        </a>#}
{#                    </li>#}

                    <li>
                        <div class="todo-item" onclick="toggleTodoDetails(event)">{{ todo.todo_title }}
                            {% if todo.todo_details %}
                                <div class="todo-detail" hidden>{{ todo.todo_details|safe }}</div>
                            {% else %}
                                <p class="todo-detail" hidden>Todo„ÅÆË©≥Á¥∞„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                            {% endif %}
                            <p>ÁôªÈå≤Êó•Ôºö{{ todo.registration_date.strftime('%Y/%m/%d %H:%M') }}<br>ÂÆå‰∫ÜÊó•‚úÖÔºö{{ todo.registration_date.strftime('%Y/%m/%d %H:%M') }}</p>
                            <div class="todo-edit-buttons" hidden>
                                <form action="/todo/delete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-del-btn">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                                <form action="/" method="get" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-edit-btn">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>ÂÆå‰∫ÜÊ∏à„Åø„ÅÆTodo„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
        {% endif %}
    </div>

    <!-- TodoËøΩÂä†„Éú„Çø„É≥ -->
    <a href="{{ url_for('create_todo_page_load') }}" style="text-decoration: none; color: inherit;">
        <div class="add-todo-button" id="add-todo-button">+</div>
    </a>

{% endblock %}