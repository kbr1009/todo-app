{% extends "base.html" %}
{% block body %}
    <!-- æ¤œç´¢ãƒãƒ¼ -->
    <div class="search-bar">
        <input type="text" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢..." id="searchInput">
        <button type="submit" >æ¤œç´¢</button>
    </div>

    <!-- TodoTab -->
    <div class="tabs">
        <button class="tab-link" onclick="openTab(event, 'Incomplete')">æœªå®Œäº† ğŸ™…</button>
        <button class="tab-link" onclick="openTab(event, 'Complete')">å®Œäº† âœ…</button>
    </div>

    <!-- TodoList -->
    <div id="Incomplete" class="tab-content">
{#        <div class="failed-alart-layer">#}
{#            <span class="fa-solid fa-circle-exclamation"></span>#}
{#            <span>å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</span>#}
{#        </div>#}
{#        <div class="success-info-layer">#}
{#            <span class="fa-solid fa-circle-check"></span>#}
{#            <span>å‰Šé™¤ã«æˆåŠŸã—ã¾ã—ãŸã€‚</span>#}
{#        </div>#}
        {% if incomplete_todos %}
            <ul>
                {% for todo in incomplete_todos %}
                    <li>
                        <div class="todo-item" onclick="toggleTodoDetails(event)">{{ todo.todo_title }}
                            <!-- è©³ç´° -->
                            {% if todo.todo_details %}
                                <div class="todo-detail" hidden>{{ todo.todo_details|safe }}</div>
                            {% else %}
                                <p class="todo-detail" hidden>Todoã®è©³ç´°ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                            {% endif %}

                            <!-- æœŸæ—¥ -->
                            {% if todo.due_date %}
                                <p class="due-date">æœŸæ—¥ï¼š{{ todo.due_date.strftime('%Y/%m/%d %H:%M') }} ({{ todo.due_date|japanese_day }})</p>
                            {% else %}
                                <p class="due-date non-due-date">æœŸæ—¥ãªã—</p>
                            {% endif %}

                            <!-- ç™»éŒ²æ—¥ -->
                            <p class="reg-todo-date" hidden>ç™»éŒ²æ—¥ï¼š{{ todo.registration_date.strftime('%Y/%m/%d %H:%M') }} ({{ todo.registration_date|japanese_day }})</p>

                            <!-- ç·¨é›†ãƒœã‚¿ãƒ³ -->
                            <div class="todo-edit-buttons" hidden>
                                <form action="/todo/delete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-del-btn">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                                <form action="/todo/amend/{{ todo.todo_id }}" method="GET" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-edit-btn">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </form>
                                <form action="/todo/clone/{{ todo.todo_id }}" method="GET" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-copy-btn">
                                        <i class="fa-solid fa-clone"></i>
                                    </button>
                                </form>
                                <form action="/todo/complete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-complete-btn">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                </form>

                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>æœªå®Œäº†ã®Todoã¯ç¾åœ¨ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        {% endif %}
    </div>

    <div id="Complete" class="tab-content" style="display: none;">
        {% if completed_todos %}
            <ul>
                {% for todo in completed_todos %}
                    <li>
                        <div class="todo-item" onclick="toggleTodoDetails(event)">{{ todo.todo_title }}
                            {% if todo.todo_details %}
                                <div class="todo-detail" hidden>{{ todo.todo_details|safe }}</div>
                            {% else %}
                                <p class="todo-detail" hidden>Todoã®è©³ç´°ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                            {% endif %}
                            <p>ç™»éŒ²æ—¥ï¼š{{ todo.registration_date.strftime('%Y/%m/%d %H:%M') }} ({{ todo.registration_date|japanese_day }})<br>å®Œäº†æ—¥ï¼š{{ todo.completed_date.strftime('%Y/%m/%d %H:%M') }} ({{ todo.completed_date|japanese_day }})</p>
                            <div class="todo-edit-buttons" hidden>
                                <form action="/todo/delete/{{ todo.todo_id }}" method="POST" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-del-btn">
                                        <i class="fa fa-trash"></i>
                                    </button>
                                </form>
                                <form action="/" method="get" class="todo-edit-btn-form">
                                    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                    <button class="todo-edit-btn">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>å®Œäº†æ¸ˆã¿ã®Todoã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        {% endif %}
    </div>

    <!-- Todoè¿½åŠ ãƒœã‚¿ãƒ³ -->
    <a href="{{ url_for('create_todo_page_load') }}" style="text-decoration: none; color: inherit;">
        <div class="add-todo-button" id="add-todo-button">+</div>
    </a>

{% endblock %}